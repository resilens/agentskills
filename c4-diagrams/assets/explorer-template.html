<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>__TITLE__</title>
    <style>
      :root {
        --bg: #f7f8fb;
        --surface: #ffffff;
        --text: #1f2937;
        --muted: #6b7280;
        --border: #d1d5db;
        --accent: #0f766e;
        --accent-soft: #ccfbf1;
      }

      * {
        box-sizing: border-box;
      }

      body {
        margin: 0;
        background: var(--bg);
        color: var(--text);
        font: 15px/1.5 "IBM Plex Sans", "Segoe UI", sans-serif;
      }

      main {
        max-width: 1200px;
        margin: 0 auto;
        padding: 1.25rem;
      }

      h1 {
        margin: 0 0 0.75rem;
        font-size: 1.5rem;
      }

      .controls {
        display: flex;
        flex-wrap: wrap;
        gap: 0.5rem;
        margin-bottom: 1rem;
      }

      .switcher {
        display: flex;
        flex-wrap: wrap;
        gap: 0.5rem;
        margin-bottom: 1rem;
      }

      button {
        border: 1px solid var(--border);
        background: var(--surface);
        color: var(--text);
        border-radius: 0.5rem;
        padding: 0.4rem 0.7rem;
        cursor: pointer;
        font: inherit;
      }

      button:hover {
        border-color: var(--accent);
      }

      .view-toggle.active {
        background: var(--accent-soft);
        border-color: var(--accent);
      }

      details {
        border: 1px solid var(--border);
        border-radius: 0.75rem;
        background: var(--surface);
        margin-bottom: 0.85rem;
        overflow: hidden;
      }

      summary {
        cursor: pointer;
        padding: 0.6rem 0.8rem;
        font-weight: 600;
      }

      .diagram-wrap {
        padding: 0.3rem 0.8rem 0.9rem;
      }

      img {
        display: block;
        width: 100%;
        max-height: 78vh;
        object-fit: contain;
        border: 1px solid var(--border);
        border-radius: 0.5rem;
        background: #fff;
      }

      .meta {
        color: var(--muted);
        margin: 0 0 1rem;
      }

      .intro {
        margin: 0 0 1rem;
      }

      .intro a {
        color: var(--accent);
      }

      .system-summary {
        margin: 0 0 1rem;
      }

      .diagram-wrap img {
        cursor: zoom-in;
      }

      .fullscreen-overlay {
        position: fixed;
        inset: 0;
        display: none;
        align-items: center;
        justify-content: center;
        background: rgba(15, 23, 42, 0.88);
        z-index: 1000;
        padding: 1.5rem;
      }

      .fullscreen-overlay.open {
        display: flex;
      }

      .fullscreen-image {
        max-width: 100%;
        max-height: calc(100vh - 4rem);
        width: auto;
        height: auto;
        border: 1px solid #334155;
        border-radius: 0.5rem;
        background: #fff;
      }

      .fullscreen-close {
        position: fixed;
        top: 1rem;
        right: 1rem;
      }
    </style>
  </head>
  <body>
    <main>
      <h1>__TITLE__</h1>
      <p class="meta">Interactive C4 Explorer</p>
      <p class="intro">
        The C4 model is an easy to learn, developer friendly approach to software
        architecture diagramming that uses multiple zoom levels to communicate
        systems clearly. See
        <a href="https://c4model.com/" target="_blank" rel="noopener noreferrer">The C4 model for visualising software architecture</a>.
      </p>
      <p class="system-summary">__SYSTEM_DESCRIPTION__</p>
      <div class="controls">
        <button type="button" id="expand-all">Expand all</button>
        <button type="button" id="collapse-all">Collapse all</button>
      </div>
      <nav class="switcher" aria-label="Diagram view switcher">
__BUTTONS__
      </nav>
      <section id="views">
__SECTIONS__
      </section>
    </main>
    <div id="fullscreen-overlay" class="fullscreen-overlay" aria-hidden="true">
      <button type="button" id="fullscreen-close" class="fullscreen-close">Close</button>
      <img id="fullscreen-image" class="fullscreen-image" alt="" />
    </div>
    <script>
      (() => {
        const details = Array.from(document.querySelectorAll(".diagram-view"));
        const toggles = Array.from(document.querySelectorAll(".view-toggle"));
        const expandAll = document.getElementById("expand-all");
        const collapseAll = document.getElementById("collapse-all");
        const diagramImages = Array.from(document.querySelectorAll(".diagram-wrap img"));
        const fullscreenOverlay = document.getElementById("fullscreen-overlay");
        const fullscreenImage = document.getElementById("fullscreen-image");
        const fullscreenClose = document.getElementById("fullscreen-close");

        if (!details.length) return;

        const setActive = (targetId) => {
          toggles.forEach((button) => {
            button.classList.toggle("active", button.dataset.target === targetId);
          });
        };

        const openOnly = (targetId) => {
          details.forEach((node) => {
            node.open = node.id === targetId;
          });
          setActive(targetId);
        };

        toggles.forEach((button) => {
          button.addEventListener("click", () => {
            const targetId = button.dataset.target;
            openOnly(targetId);
            const target = document.getElementById(targetId);
            if (target) target.scrollIntoView({ behavior: "smooth", block: "start" });
          });
        });

        details.forEach((node) => {
          node.addEventListener("toggle", () => {
            if (!node.open) return;
            details.forEach((other) => {
              if (other !== node) other.open = false;
            });
            setActive(node.id);
          });
        });

        expandAll.addEventListener("click", () => {
          details.forEach((node) => {
            node.open = true;
          });
          toggles.forEach((button) => button.classList.remove("active"));
        });

        collapseAll.addEventListener("click", () => {
          details.forEach((node) => {
            node.open = false;
          });
          toggles.forEach((button) => button.classList.remove("active"));
        });

        const openFullscreen = (img) => {
          fullscreenImage.src = img.src;
          fullscreenImage.alt = img.alt || "";
          fullscreenOverlay.classList.add("open");
          fullscreenOverlay.setAttribute("aria-hidden", "false");
        };

        const closeFullscreen = () => {
          fullscreenOverlay.classList.remove("open");
          fullscreenOverlay.setAttribute("aria-hidden", "true");
          fullscreenImage.removeAttribute("src");
          fullscreenImage.alt = "";
        };

        diagramImages.forEach((img) => {
          img.addEventListener("click", () => openFullscreen(img));
        });

        fullscreenClose.addEventListener("click", closeFullscreen);
        fullscreenOverlay.addEventListener("click", (event) => {
          if (event.target === fullscreenOverlay) closeFullscreen();
        });
        window.addEventListener("keydown", (event) => {
          if (event.key === "Escape" && fullscreenOverlay.classList.contains("open")) {
            closeFullscreen();
          }
        });

        const firstOpen = details.find((node) => node.open) || details[0];
        openOnly(firstOpen.id);
      })();
    </script>
  </body>
</html>
